[2024-03-02T15:55:21.331+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: Batching_Data.Scrapping scheduled__2024-03-02T15:10:00+00:00 [queued]>
[2024-03-02T15:55:21.358+0000] {taskinstance.py:1165} INFO - Dependencies all met for <TaskInstance: Batching_Data.Scrapping scheduled__2024-03-02T15:10:00+00:00 [queued]>
[2024-03-02T15:55:21.359+0000] {taskinstance.py:1362} INFO - 
--------------------------------------------------------------------------------
[2024-03-02T15:55:21.360+0000] {taskinstance.py:1363} INFO - Starting attempt 12 of 12
[2024-03-02T15:55:21.361+0000] {taskinstance.py:1364} INFO - 
--------------------------------------------------------------------------------
[2024-03-02T15:55:21.403+0000] {taskinstance.py:1383} INFO - Executing <Task(PythonOperator): Scrapping> on 2024-03-02 15:10:00+00:00
[2024-03-02T15:55:21.419+0000] {standard_task_runner.py:55} INFO - Started process 310 to run task
[2024-03-02T15:55:21.426+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'Batching_Data', 'Scrapping', 'scheduled__2024-03-02T15:10:00+00:00', '--job-id', '259', '--raw', '--subdir', 'DAGS_FOLDER/Batching_Data.py', '--cfg-path', '/tmp/tmpekie2fil']
[2024-03-02T15:55:21.431+0000] {standard_task_runner.py:83} INFO - Job 259: Subtask Scrapping
[2024-03-02T15:55:21.577+0000] {task_command.py:376} INFO - Running <TaskInstance: Batching_Data.Scrapping scheduled__2024-03-02T15:10:00+00:00 [running]> on host 3757548564a1
[2024-03-02T15:55:21.761+0000] {taskinstance.py:1592} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Bob Sebastian
AIRFLOW_CTX_DAG_ID=Batching_Data
AIRFLOW_CTX_TASK_ID=Scrapping
AIRFLOW_CTX_EXECUTION_DATE=2024-03-02T15:10:00+00:00
AIRFLOW_CTX_TRY_NUMBER=12
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-03-02T15:10:00+00:00
[2024-03-02T15:55:32.375+0000] {warnings.py:110} WARNING - /home/***/.local/lib/python3.7/site-packages/sklearn/base.py:338: UserWarning: Trying to unpickle estimator LabelEncoder from version 1.2.2 when using version 1.0.2. This might lead to breaking code or invalid results. Use at your own risk. For more info please refer to:
https://scikit-learn.org/stable/modules/model_persistence.html#security-maintainability-limitations
  UserWarning,

[2024-03-02T15:55:33.105+0000] {taskinstance.py:1851} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 193, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/Batching_Data.py", line 104, in batching_data
    predicted_class = prediction['prediction']
KeyError: 'prediction'
[2024-03-02T15:55:33.135+0000] {taskinstance.py:1406} INFO - Marking task as FAILED. dag_id=Batching_Data, task_id=Scrapping, execution_date=20240302T151000, start_date=20240302T155521, end_date=20240302T155533
[2024-03-02T15:55:33.136+0000] {taskinstance.py:1619} ERROR - Error when executing on_failure callback
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1457, in _run_raw_task
    self._execute_task_with_callbacks(context, test_mode)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1603, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1659, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 193, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/Batching_Data.py", line 104, in batching_data
    predicted_class = prediction['prediction']
KeyError: 'prediction'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 1617, in _run_finished_callback
    callback(context)
TypeError: batching_data() takes 0 positional arguments but 1 was given
[2024-03-02T15:55:33.169+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 259 for task Scrapping ('prediction'; 310)
[2024-03-02T15:55:33.252+0000] {local_task_job.py:164} INFO - Task exited with return code 1
[2024-03-02T15:55:33.332+0000] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
